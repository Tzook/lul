'use strict';
let Socket = require('socket.io/lib/socket');
let emit = require('events').EventEmitter.prototype.emit;
Socket.prototype.onevent = function (packet) {
    var args = packet.data || ['error'];
    args.push(this);
    if (null != packet.id) {
        args.push(this.ack(packet.id));
    }
    emit.apply(this, args);
};
Socket.prototype.onclose = function (reason) {
    if (!this.connected) {
        return this;
    }
    this.leaveAll();
    this.nsp.remove(this);
    this.client.remove(this);
    this.connected = false;
    this.disconnected = true;
    delete this.nsp.connected[this.id];
    this.emit('disconnect', reason, this);
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NlcnZlci9saWIvc29ja2V0aW8vc29ja2V0aW8uZml4ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDO0FBQ2IsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLHNCQUFzQixDQUFDLENBQUM7QUFDN0MsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDO0FBR3pELE1BQU0sQ0FBQyxTQUFTLENBQUMsT0FBTyxHQUFHLFVBQW9CLE1BQU07SUFDbkQsSUFBSSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3BDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFaEIsRUFBRSxDQUFDLENBQUMsSUFBSSxJQUFJLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3RCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRUQsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDekIsQ0FBQyxDQUFDO0FBR0YsTUFBTSxDQUFDLFNBQVMsQ0FBQyxPQUFPLEdBQUcsVUFBb0IsTUFBTTtJQUNuRCxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQ3BCLE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBQ0QsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ2hCLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3RCLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3pCLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO0lBQ3ZCLElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO0lBQ3pCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ25DLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztBQUN4QyxDQUFDLENBQUMiLCJmaWxlIjoibGliL3NvY2tldGlvL3NvY2tldGlvLmZpeGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xubGV0IFNvY2tldCA9IHJlcXVpcmUoJ3NvY2tldC5pby9saWIvc29ja2V0Jyk7XG5sZXQgZW1pdCA9IHJlcXVpcmUoJ2V2ZW50cycpLkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdDtcblxuLy8gU21hbGwgZml4IG9uIHRoZSBvbmV2ZW50LCB0byBtYWtlIHRoZSBzb2NrZXQgYmUgc2VudCBhcyBhbiBleHJ0YSBwYXJhbWV0ZXIgb24gZXZlbnRzXG5Tb2NrZXQucHJvdG90eXBlLm9uZXZlbnQgPSBmdW5jdGlvbih0aGlzOiBhbnksIHBhY2tldCkge1xuICB2YXIgYXJncyA9IHBhY2tldC5kYXRhIHx8IFsnZXJyb3InXTsgLy8gQURERUQgJ2Vycm9yJ1xuICBhcmdzLnB1c2godGhpcyk7IC8vIEFEREVEIFRISVMgTElORVxuXG4gIGlmIChudWxsICE9IHBhY2tldC5pZCkge1xuICAgIGFyZ3MucHVzaCh0aGlzLmFjayhwYWNrZXQuaWQpKTtcbiAgfVxuXG4gIGVtaXQuYXBwbHkodGhpcywgYXJncyk7XG59O1xuXG4vLyBzb2NrZXQgYXMgYSBwYXJhbWV0ZXIgZm9yIGRpc2Nvbm5lY3QgZXZlbnQgdG9vXG5Tb2NrZXQucHJvdG90eXBlLm9uY2xvc2UgPSBmdW5jdGlvbih0aGlzOiBhbnksIHJlYXNvbikge1xuICBpZiAoIXRoaXMuY29ubmVjdGVkKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgdGhpcy5sZWF2ZUFsbCgpO1xuICB0aGlzLm5zcC5yZW1vdmUodGhpcyk7XG4gIHRoaXMuY2xpZW50LnJlbW92ZSh0aGlzKTtcbiAgdGhpcy5jb25uZWN0ZWQgPSBmYWxzZTtcbiAgdGhpcy5kaXNjb25uZWN0ZWQgPSB0cnVlO1xuICBkZWxldGUgdGhpcy5uc3AuY29ubmVjdGVkW3RoaXMuaWRdO1xuICB0aGlzLmVtaXQoJ2Rpc2Nvbm5lY3QnLCByZWFzb24sIHRoaXMpOyAvLyBBRERFRCB0aGUgcGFyYW1ldGVyICd0aGlzJ1xufTsiXX0=
